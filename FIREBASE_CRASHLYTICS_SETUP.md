["Firebase Console](https://console.firebase.google.com/)\n2. Select your project\n3. Click on the gear icon (Project Settings)\n4. Select your Android app from the list\n5. Download `google-services.json`\n6. Place it in the `android/app/` directory\n\n### 2.2 Update android/app/build.gradle\n\nAdd the Google Services plugin:\n\n```gradle\napply plugin: 'com.google.gms.google-services'\n```\n\n### 2.3 Update android/build.gradle (project level)\n\nAdd the Google Services classpath:\n\n```gradle\nbuildscript {\n    dependencies {\n        // ... other dependencies\n        classpath 'com.google.gms:google-services:4.3.15'\n    }\n}\n```\n\n## Step 3: Configure Firebase for iOS\n\n### 3.1 Download GoogleService-Info.plist\n\n1. Go to [Firebase Console](https://console.firebase.google.com/)\n2. Select your project\n3. Click on the gear icon (Project Settings)\n4. Select your iOS app from the list\n5. Download `GoogleService-Info.plist`\n6. Place it in the `ios/` directory\n\n### 3.2 Add to Xcode\n\n1. Open your project in Xcode\n2. Drag `GoogleService-Info.plist` into your project\n3. Make sure it's added to all targets\n\n## Step 4: Initialize Crashlytics in Your App\n\nUpdate `App.tsx` to initialize Crashlytics:\n\n```typescript\nimport React, { useEffect } from 'react';\nimport crashlytics from '@react-native-firebase/crashlytics';\n\n// ... other imports\n\nexport default function App() {\n  useEffect(() => {\n    // Initialize Crashlytics\n    crashlytics().setCrashlyticsCollectionEnabled(true);\n    \n    // Set user identifier (optional)\n    // crashlytics().setUserId('user-123456');\n  }, []);\n\n  return (\n    // ... existing app code\n  );\n}\n```\n\n## Step 5: Add Error Logging to Push Token Registration\n\nUpdate `services/pushTokenService.ts` to log errors to Crashlytics:\n\n```typescript\nimport crashlytics from '@react-native-firebase/crashlytics';\n\nexport async function registerPushTokenForUser(userId: string) {\n  if (!userId) {\n    console.log('[pushTokenService] No userId provided, skipping registration');\n    return;\n  }\n  if (Platform.OS === 'web') {\n    console.log('[pushTokenService] Web platform, skipping registration');\n    return;\n  }\n\n  console.log('[pushTokenService] Starting push token registration for user:', userId);\n  console.log('[pushTokenService] Platform:', Platform.OS);\n\n  try {\n    const granted = await requestNotificationPermissions();\n    if (!granted) {\n      const error = new Error('Notification permissions not granted');\n      console.error('[pushTokenService]', error.message);\n      \n      // Log to Crashlytics\n      crashlytics().log('[pushTokenService] Notification permissions not granted');\n      crashlytics().recordError(error);\n      \n      return;\n    }\n\n    console.log('[pushTokenService] Permissions granted, proceeding to get push token...');\n\n    const expoPushToken = await getPushToken();\n    if (!expoPushToken) {\n      const error = new Error('No expoPushToken retrieved');\n      console.error('[pushTokenService]', error.message);\n      \n      // Log to Crashlytics\n      crashlytics().log('[pushTokenService] No expoPushToken retrieved');\n      crashlytics().recordError(error);\n      \n      return;\n    }\n\n    console.log('[pushTokenService] Push token retrieved successfully, registering device...');\n\n    const deviceDocId = `${Platform.OS}-${expoPushToken.substring(0, 20)}`;\n    const deviceRef = doc(db, 'users', userId, 'devices', deviceDocId);\n\n    const payload: DeviceRegistration = {\n      expoPushToken,\n      platform: Platform.OS,\n      updatedAt: serverTimestamp(),\n    };\n\n    console.log('[pushTokenService] Registering device:', deviceDocId);\n    console.log('[pushTokenService] Device payload:', {\n      platform: Platform.OS,\n      tokenLength: expoPushToken.length,\n      tokenPrefix: expoPushToken.substring(0, 20),\n    });\n\n    await setDoc(deviceRef, payload, { merge: true });\n    console.log('[pushTokenService] Successfully registered device token for user:', userId);\n    \n    // Log success to Crashlytics\n    crashlytics().log(`[pushTokenService] Successfully registered device for user: ${userId}`);\n    \n  } catch (error) {\n    console.error('[pushTokenService] Failed to register device token:', error);\n    console.error('[pushTokenService] Error details:', {\n      code: (error as any)?.code,\n      message: (error as any)?.message,\n      userId,\n      deviceDocId: `${Platform.OS}-${(await getPushToken())?.substring(0, 20) || 'unknown'}`,\n    });\n    \n    // Log to Crashlytics with full error details\n    crashlytics().log('[pushTokenService] Failed to register device token');\n    crashlytics().recordError(error as Error);\n    crashlytics().setAttribute('userId', userId);\n    crashlytics().setAttribute('platform', Platform.OS);\n    crashlytics().setAttribute('errorCode', (error as any)?.code || 'unknown');\n    crashlytics().setAttribute('errorMessage', (error as any)?.message || 'unknown');\n  }\n}\n```\n\n## Step 6: Test the Setup\n\n### 6.1 Build and Install the App\n\n```bash\n# Build for Android\neas build --profile production --platform android\n\n# Or for development testing\neas build --profile development --platform android\n```\n\n### 6.2 Trigger an Error (Optional)\n\nTo test that Crashlytics is working, you can add a test button that triggers an error:\n\n```typescript\nimport crashlytics from '@react-native-firebase/crashlytics';\n\nconst testCrashlytics = () => {\n  crashlytics().log('Testing Crashlytics');\n  crashlytics().recordError(new Error('Test error from app'));\n  console.log('Test error logged to Crashlytics');\n};\n```\n\n### 6.3 Check Firebase Console\n\n1. Go to [Firebase Console](https://console.firebase.google.com/)\n2. Select your project\n3. Navigate to **Crashlytics** in the left sidebar\n4. You should see any errors that occurred in your app\n\n## Step 7: Diagnose the Android Issue\n\nAfter setting up Crashlytics and deploying the updated app:\n\n1. **Log in with your Android account**\n2. **Wait a few minutes** for the app to attempt push token registration\n3. **Check Firebase Console \u2192 Crashlytics** for any errors\n4. **Look for errors with these messages:**\n   - `[pushTokenService] Notification permissions not granted`\n   - `[pushTokenService] No expoPushToken retrieved`\n   - `[pushTokenService] Failed to register device token`\n\n## Common Issues and Solutions\n\n### Issue: \"Notification permissions not granted\"\n\n**Solution:** The user denied notification permissions. You need to:\n1. Go to Android Settings \u2192 Apps \u2192 Your App \u2192 Notifications\n2. Enable notifications\n3. Re-open the app\n\n### Issue: \"No expoPushToken retrieved\"\n\n**Solution:** The Expo project ID might be incorrect. Check:\n1. `services/notificationService.ts` line 118\n2. Verify the project ID matches your Expo project\n\n### Issue: \"Failed to register device token", "Solution:** Check the error code and message in Crashlytics:\n- `PERMISSION_DENIED`: Firestore security rules issue\n- `UNAVAILABLE`: Network issue\n- `INVALID_ARGUMENT`: Invalid data format\n\n## Next Steps\n\nOnce you have Crashlytics set up and can see the errors:\n\n1. **Share the error details** from Crashlytics\n2. **We can then fix the specific issue** preventing device registration\n3. **Test the fix** by deploying an updated build\n\n## Additional Resources\n\n- [Firebase Crashlytics Documentation](https://firebase.google.com/docs/crashlytics)\n- [React Native Firebase Crashlytics](https://rnfirebase.io/crashlytics/usage)\n- [Expo Setup Guide](https://docs.expo.dev/guides/setup-eas-builds/)"]